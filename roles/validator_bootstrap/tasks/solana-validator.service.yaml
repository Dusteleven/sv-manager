---
- name: Remove solana validator service from etc
  file:
    path: /etc/systemd/system/solana-validator.service
    state: absent
  tags:
    - validator.service.solana

- name: Create solana validator service
  template:
    src: solana-validator.service.j2
    dest: /lib/systemd/system/solana-validator.service
    mode: 0644
    owner: root
    group: root
  tags:
    - validator.service.solana

- name: Add default environments file
  template:
    src: solana-validator.j2
    dest: /etc/default/solana-validator
    mode: 0644
    owner: root
    group: root
  tags:
    - validator.service.solana

- name: Reload systemd
  systemd:
    daemon_reload: yes
  tags:
    - validator.service.solana

- name: Enable solana service
  systemd:
    name: solana-validator
    enabled: yes
  tags:
    - validator.service.solana

- name: Start solana service
  systemd:
    name: solana-validator
    state: "{{ item }}"
  with_items:
    - "started"
    - "restarted"
  tags:
    - validator.service.solana

